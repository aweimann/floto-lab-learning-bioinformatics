<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Chris Ruis" />


<title>Introduction to R</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Learning bioinformatics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="introduction.to.R.html">Introduction to R</a>
</li>
<li>
  <a href="how.to.use.RStudio.html">How to use RStudio</a>
</li>
<li>
  <a href="glossary.of.R.terms.html">Glossary of R terms</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Introduction to R</h1>
<h4 class="author">Chris Ruis</h4>

</div>


<p>In this tutorial, we’re going to run through the basics of R. R is a programming language that is brilliant for data analysis and plotting and contains a whole series of useful additions for analysing more complicated data like RNASeq and phylogenetic trees. R is very good at doing anything you might usually do in excel, plus a whole lot more. You can write your analyses in the form of a script which means your work will be reproducible and you won’t have to remember all of the specifics of what you’ve done to be able to do it again. The easiest way to get up and running with R is to download RStudio (<a href="https://rstudio.com/products/rstudio/download/" class="uri">https://rstudio.com/products/rstudio/download/</a> the free version is fine). You can write all of the code in RStudio and it contains handy features like a help bar and a window for plots.</p>
<p>Each section finishes with a set of exercises that put into practice what we’ve covered in that section.</p>
<div id="variables-and-data-types" class="section level1">
<h1><span class="header-section-number">1</span> Variables and data types</h1>
<p>So if you open RStudio, you should see four windows. For this tutorial, we’re going to use the bottom left window, which has a little tab above it saying “Console”. The first thing we’re going to look at is variables. Whatever level of programming expertise you reach, you’re going to use variables. Variables are objects that you can multiply, plot, perform complex calculations on or do pretty much anything else with. This next bit of code generates a variable ‘a’ and gives it a value of 1. When you see a box like this, type everything before the ‘#’ into that bottom left window in RStudio, one line at a time. The text after the # gives you a bit more information about the code</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co">#Type this line before the # into the bottom left window of RStudio</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">print</span>(a) <span class="co">#And then type this line before the #</span></a></code></pre></div>
<p>Ok, so what have we just done? The line “a &lt;- 1” creates a variable called “a” and gives it a value of 1. This means that whenever we type “a” into R, R will interpret that “a” as the number 1. So when we then type “print(a)”, R interprets the “a” as 1 and prints 1 to the screen. Whenever you want to create a new variable, we use “variable &lt;- value”. As we’ll see later on, that value doesn’t just need to be a single number. Why the “&lt;-” is used, I have no idea - surely “=” would be easier. But “&lt;-” is what is used to assign a variable to a value.</p>
<center>
<img src="images/Intro_to_R/Data_types.png" alt="The main data-types are numeric, character and logic. Along with them, there is also complex and integers but we won’t focus on these during this tutorial." />
</center>
<p>As a brief but important aside, you need to keep in mind the type of data that you’re working with. When we read some text, our brains see words and recognise them as words. While if we see a number, our brain recognises that as a number. R won’t necessarily recognise words as words or numbers as numbers, so we need to make sure that our data is recognised correctly. There’s 3 main data types to recognise: character (what we’d recognise as words or text), numeric (numbers, either whole numbers or decimals) and logical (true or false). R will do different things with these different data types - for example you can’t multiply a word by 2. Here’s a few lines of code to illustrate the different variable types:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co">#This assigns the variable a to a numeric value</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">typeof</span>(a) <span class="co">#Prints &quot;double&quot; which is what R calls numerical values</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">a <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="co">#R knows &quot;a&quot; is a number so multiplies this by 2 as we would expect</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">b &lt;-<span class="st"> &quot;flotolab&quot;</span> <span class="co">#This assigns the variable b to a character object</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw">typeof</span>(b) <span class="co">#Prints &quot;character&quot;</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">b <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="co">#Should print an error message as R doesn&#39;t know how to multiply a word by 2</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">d &lt;-<span class="st"> </span><span class="ot">TRUE</span> <span class="co">#This assigns the variable d to a logical value</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="kw">typeof</span>(d) <span class="co">#Prints &quot;logical&quot;</span></a></code></pre></div>
<p>When we tried to multiply b by 2, we get an error message because b is not a numerical variable, so R doesn’t know how to multiply it (neither do I, come to that). Most of the time, you’ll probably work with numbers and R will try to interpret your data as numbers where it can. So most of the time, you don’t need to do anything to work with your data. But if you get an error message, the type of the variable is often a good place to start to see what might be going wrong.</p>
<hr />
<p><strong>Exercises</strong></p>
<ol style="list-style-type: decimal">
<li>Create a new variable containing your favourite number and multiply it by 10</li>
<li>Create a new variable containing your name</li>
</ol>
<hr />
</div>
<div id="vectors" class="section level1">
<h1><span class="header-section-number">2</span> Vectors</h1>
<p>So we’ve seen how to create simple variables that contain individual numbers or words. But most of the time, we’re not dealing with single values. Most data consists of a series of values. So how do we deal with series of values in R? The answer will often be to use a vector. Say we’ve measured the membrane potential of 10 different cells. We can represent these 10 measurements as a vector using:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">memPotMeasurements &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.2</span>,<span class="fl">2.4</span>,<span class="fl">1.7</span>,<span class="fl">3.4</span>,<span class="fl">1.4</span>,<span class="fl">1.4</span>,<span class="fl">2.2</span>,<span class="fl">2.5</span>,<span class="fl">1.9</span>,<span class="fl">1.5</span>) <span class="co">#This is a vector</span></a></code></pre></div>
<p>To create a vector, we use the “&lt;-” as before to create a new variable called memP otMeasurements. But now, instead of assigning that variable to a single value, we assign it to a set of values. We use “c()” to create a vector of the values within the brackets.</p>
<center>
<img src="images/Intro_to_R/Data_structures_1.png" alt="Along with vectors, matrixes and arrays represents the homogeneous data structures in R. A matrix is a 2-D vector (columns and rows), and arrays are N-dimensional (like a stack of n-matrixes). They are homogeneous because they only admit one data type." />
</center>
<p>R is very good at working with vectors as you can perform mathematical operations on the entire vector in one go. For example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">memPotMeasurements <span class="op">*</span><span class="st"> </span><span class="dv">2</span></a></code></pre></div>
<p>Compare the output from this to the values that we assigned to memPotMeasurements. You should see that R has multiplied every value within the vector by 2. This is what R will do with vectors by default. The variable memPotMeasurements has not, however, been changed. Type:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">print</span>(memPotMeasurements)</a></code></pre></div>
<p>You can see that memPotMeasurements still contains the values that we initially assigned. When we performed the function above, R printed the new values to the screen but left the original variable unchanged.</p>
<hr />
<p><strong>Exercises</strong></p>
<ol start="3" style="list-style-type: decimal">
<li>Create a new variable containing 10 numbers (any numbers you like) and multiply these numbers by 10</li>
</ol>
<hr />
</div>
<div id="data-frames" class="section level1">
<h1><span class="header-section-number">3</span> Data frames</h1>
<p>Vectors can be useful when you have a series of measurements of a single variable. However, what about when we have tables of data? In this case, its most common to use a data frame and indeed, this is probably what you’ll use most in R. I think of a data frame as being like an excel spreadsheet - you have columns and rows in the same way and I’ll often look at the data in R data frames before and/or after in excel. So basically any data that you usually look at in excel, you can represent as a data frame in R. With vectors, you can only have one data type - for example try typing:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">myVector &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="st">&quot;a&quot;</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">print</span>(myVector)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">myVector <span class="op">*</span><span class="st"> </span><span class="dv">2</span></a></code></pre></div>
<p>We look at myVector and we see 5 numbers and 1 letter. However, R will treat all of the data in a vector as a single data type so when you print myVector, you can see the values are all surrounded by quotes, which is how R shows its treating them all as character values. Therefore we get an error message when we try to multiply the vector by 2. Data frames are a little different. Every column in a data frame can have a different data type, but the data type has to be the same within a column. This is very similar to how we’d normally have data in excel, with maybe columns of sample names and columns of numerical measurements.</p>
<p>To create a data frame we use:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">memPotDF &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Sample =</span> <span class="kw">c</span>(<span class="st">&quot;Sample1&quot;</span>,<span class="st">&quot;Sample2&quot;</span>,<span class="st">&quot;Sample3&quot;</span>,<span class="st">&quot;Sample4&quot;</span>,<span class="st">&quot;Sample5&quot;</span>), <span class="dt">Measurement1 =</span> <span class="kw">c</span>(<span class="fl">1.2</span>,<span class="fl">1.4</span>,<span class="fl">2.5</span>,<span class="fl">2.7</span>,<span class="fl">1.6</span>), <span class="dt">Measurement2 =</span> <span class="kw">c</span>(<span class="fl">1.4</span>,<span class="fl">1.5</span>,<span class="fl">2.2</span>,<span class="fl">2.8</span>,<span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">print</span>(memPotDF)</a></code></pre></div>
<p>We’ve created a data frame that has 3 columns. The first column is the sample name and then columns 2 and 3 are here independent measurements of the membrane potential in that sample. Column 1 contains character data while columns 2 and 3 contain numerical data. What we’ve actually done when we’ve created the data frame is made 3 vectors called “Sample”, “Measurement1” and “Measurement2” and then combined those vectors into a data frame.</p>
<center>
<img src="images/Intro_to_R/Data_structures_2.png" alt="A data frame is the most similar object to an excel sheet where we input different data types in different columns. The two requirements are: all columns have the same lenght and every column has only one data type. A list allow us a bit more of fexibility becase they can store objects of different lenght." />
</center>
<p>We can carry out operations on individual columns, rows or cells of a data frame. Here, we use square brackets to tell R which row(s), column(s) or cell(s) we want to specify. To tell R we want to pick out values from within a data frame, we put square brackets after the data frame name, like so: memPotDF[,]. The comma within the square brackets is used to identify rows and columns. So to pick out one or more rows, put the number(s) of the row before the comma, so memPotDF[1,] will extract row 1. For a column, put the number(s) of the column after the comma, so memPotDF[,1] will extract column 1. If you want a specific cell in the data frame, give its row and column position, so memPotDF[1,1] picks out the value in column 1 of row 1. Here’s some examples of pulling out rows, columns, cells and doing things with those values:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">memPotDF[<span class="dv">1</span>,] <span class="co">#Print row 1</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">memPotDF[,<span class="dv">1</span>] <span class="co">#Print column 1</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">memPotDF[<span class="dv">1</span>,<span class="dv">1</span>] <span class="co">#Print the value in column 1 of row 1</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">memPotDF[,<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="co">#Multiply all values in column 2 by 2</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">memPotDF[<span class="dv">2</span>,<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="co">#Multiply the value in column 2 of row 2 by 2</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6">memPotDF[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),] <span class="co">#Print rows 1 and 2</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7">memPotDF[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,] <span class="co">#Also prints rows 1 and 2</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8">memPotDF[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">1</span>] <span class="co">#Print the value in column 1 of rows 1 and 2</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9">memPotDF[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)] <span class="co">#Print the values in columns 1 and 2 of rows 1 and 2</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10">memPotDF<span class="op">$</span>Measurement1 <span class="co">#Print the column in the data frame with name Measurement1</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11">memPotDF<span class="op">$</span>Measurement2 <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="co">#Multiply all values in the column with name Measurement2 by 2</span></a></code></pre></div>
<p>There’s 2 ways of picking out a column of interest. You can either use the column number in square brackets or use “$” followed by the column name. So memPotDF[,2] and memPotDF$Measurement1 give the same output. Likewise, there’s two ways of picking out multiple columns or rows of interest. You can either use c(1,2) which extracts the columns or rows within the brackets (through creating a vector with the specified numbers in). Or, if and only if you want to pull out a continuous run of columns or rows, you can use 1:2 which creates a sequence containing the integer numbers between the first and second numbers and extracts these columns or rows. so memPotDF[,c(1,2)] and memPotDF[,1:2] give the same output.</p>
<hr />
<p><strong>Exercises</strong></p>
<ol start="4" style="list-style-type: decimal">
<li>Create a data frame with 2 columns - the first column containing your 5 favourite TV shows and the second column containing the number of episodes of those TV shows you reckon you’ve watched in the last month (roughly, hopefully its less than 3 figures)</li>
<li>Use square brackets to pick out the number of episodes you’ve watched of your second favourite TV show</li>
<li>Imagine your TV watching is going to be similar next month to this month. Calculate the number of episodes of each show you will have watched across the 2 month period by multiplying the number of episodes column by 2</li>
</ol>
<hr />
</div>
<div id="functions" class="section level1">
<h1><span class="header-section-number">4</span> Functions</h1>
<p>So we now know how to create variables containing individual values, sets of values and tables of values and how to perform some simple operations with them. But you’ll often want to perform more complicated operations than multiplying values. To do this, you can use functions. Functions take an input, do something to that input and give you an output. As an example using our memPotMeasurements vector from above:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">mean</span>(memPotMeasurements)</a></code></pre></div>
<p>Here, “mean” is the function and the object(s) within the brackets are the input to the function. It takes our vector as input, calculates the mean of the values in that vector and gives us that mean as the output. We can also calculate the mean of a column in our data frame using:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">mean</span>(memPotDF[,<span class="dv">2</span>])</a></code></pre></div>
<p>Which will give us the mean of the values in column 2 of memPotDF. R contains hundreds of functions, each of which takes some input, carries out some particular operation or set of operations and gives you some output. The type of data used as input and given as output will be different for different functions. There’s pretty much always a function that will do what you want to do with your data, the art is in finding it! You’ll see more functions in the statistics tutorial but for now here’s a few examples:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">print</span>(object) <span class="co">#Prints the object to the screen, will work with any type of data</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw">mean</span>(object) <span class="co">#Calculates the mean of an object</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw">median</span>(object) <span class="co">#Calculates the median of an object</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="kw">seq</span>(from, to, by) <span class="co">#Creates a sequence of numbers starting at &quot;from&quot; and ending at &quot;to&quot; with increasing each value by &quot;by&quot;</span></a></code></pre></div>
<p>The functions print(), mean() and median() take a single object. But not all functions take a single value. The function seq() is an example of a function that takes 3 “arguments”. The purpose of seq() is to produce a sequence of numbers and the 3 arguments determine the sequence that will be produced. The sequence will start at the number given by “from”, will end at the number given by “to” and will ascend or descend by the number given by “by”. Try:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">1</span>)</a></code></pre></div>
<p>These 2 commands give us the same output and illustrate that there’s different ways of running the function. As we know that seq() takes 3 arguments, we can either just give it 3 numbers, 1 per argument, or we specify which numbers correspond to each variable in the function, which here are “from”, “to” and “by”. If ever you’re not sure about how to run a function or what needs to go in it, type “?” followed by the function name, for example:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">?seq</a></code></pre></div>
<p>This will bring up the help page for the function in the bottom right window of RStudio which contains the details on how to run the function. Most functions will only work with a specific data type, so if the function isn’t working as you’d expect checking that you’re giving it the correct type of data is often a good place to start.</p>
<p>You can also create your own functions. For example, if there’s a particular operation that you regularly carry out with your data, you can either write the code to do that each time or your can write a function. Writing it as a function has the advantage that you know its doing the same each time you run it and it will save you having to type it each time. So let’s write an example function:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">multiplyTwoNumbers &lt;-<span class="st"> </span><span class="cf">function</span>(x,y) {</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">  z &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3">  <span class="kw">print</span>(z <span class="op">*</span><span class="st"> </span>y)}</a></code></pre></div>
<p>We’ve created a function here called “multiplyTwoNumbers”. We assign the function to the name “multiplyTwoNumbers” using the “&lt;-” just as we’d assign a value to a variable. The function(x,y) part says that the function is going to take 2 values. The code between the “{” and “}” is the code that will run within the function. So here, the function adds 1 to the number “x” and assigns that to a new variable “z”. It then multiplies “z” by “y”. And then prints the output to the screen. To run that function we use either of:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">multiplyTwoNumbers</span>(<span class="dv">1</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw">multiplyTwoNumbers</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="dv">5</span>)</a></code></pre></div>
<p>So once you’ve written the code for the function, you run it exactly as you would one of R’s in built functions.</p>
<hr />
<p><strong>Exercises</strong></p>
<ol start="7" style="list-style-type: decimal">
<li>Write a function that takes 3 numbers, multiplies the first two numbers together and adds this to the third number</li>
<li>Run your function on different sets of 3 numbers</li>
</ol>
<hr />
</div>
<div id="libraries" class="section level1">
<h1><span class="header-section-number">5</span> Libraries</h1>
<center>
<img src="images/Intro_to_R/R_packages.png" alt="A data frame is the most similar object to an excel sheet where we input different data types in different columns. The two requirements are: all columns have the same lenght and every column has only one data type. A list allow us a bit more of fexibility becase they can store objects of different lenght. Image taken from Ryan Wesslen" />
</center>
<p>The functions we ran above are all quite generic and simple functions. But the types of data that we work with are often quite complex and we want to do things that are far more complicated. The good news is that most of what we need to do, other people have needed to do before. And even if they haven’t, people have usually wanted to do something quite similar. There’s a whole series of more complicated functions that are found in libraries. A library is a set of functions that can be useful for a particular type of tasks. For example, if you’re working with RNASeq data, there’s a library called DESeq2 that contains all of the functions you need to carry out differential gene expression analysis. If you want to work with a phylogenetic tree (which everyone should), there’s a library called ape which contains lots of functions to analyse phylogenetic trees. And for most of these libraries, there’s good documentation and tutorials online to help you get up to speed with exactly how to run all of their functions. Setting yourself up to use the functions in a library requires 2 commands:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">&quot;DESeq2&quot;</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw">library</span>(DESeq2)</a></code></pre></div>
<p>The first step is to install the package on your computer and that’s what the first line of code does. Once you’ve installed the package, you need to load it to use the functions and you do that with “library(PackageName)”. You only need to install the package once but you’ll need to reload the library every time that you open a new RStudio session.</p>
<hr />
<p><strong>Exercises</strong></p>
<ol start="8" style="list-style-type: decimal">
<li>Install and then load the package ggplot2</li>
</ol>
<hr />
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD #Data tables</p>
<p>We learnt how to use data frames in the previous section. Data tables are a more powerful version of a data frame and its a bit easier to do things like selecting particular columns and pulling out rows that match particular criteria.</p>
</div>
<div id="loops-and-conditionals" class="section level1">
<h1><span class="header-section-number">6</span> #Loops and conditionals</h1>
</div>
<div id="loops-and-conditionals-1" class="section level1">
<h1><span class="header-section-number">7</span> Loops and conditionals</h1>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>3491b5a9141685aaee63ae8d63caace5abdccde6</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>Often you’ll find that you have a set of data and you want to do the same thing with each of the individual data points in the set. We saw earlier how you can multiply all of the values in a vector or column but what if you want to do something more complicated? And what if you only want to perform an operation with a subset of the data, for example if they match a particular criteria. One way in which you can achieve this is using for loops and if statements. Here’s a couple of examples of for loops and if statements that are similar to things you may want to do with your data:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co">#In this first example, we&#39;re going to start with a vector and multiply each value in the vector by 2 in turn</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">allValues &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>) <span class="co">#Create a vector containing 5 numbers</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="cf">for</span> (eachValue <span class="cf">in</span> allValues) {</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">  <span class="kw">print</span>(eachValue <span class="op">*</span><span class="st"> </span><span class="dv">2</span>)}</a></code></pre></div>
<p>The for loop goes through each value in an object in turn and does something with it. Here, we type “for (eachValue in allValues) {”. The for loop goes through the object called “allValues” and takes one value at a time. It gives the value it is currently on the name “eachValue” so you can refer to it and do things with it in the rest of the for loop. You can give the value whatever name you like here, I’ve used eachValue but it often helps to call it something relevant to your data to help you remember exactly what you’re iterating through. With a for loop, you tell R which values you want to go through using the text between the “(” and “)”. You then have one or more lines of code between the “{” and “}” which says what you want to do with each value. In our case here, we want to multiply each value by 2 and print the resulting number to the screen. That’s the basic setup of a for loop. You tell R what values you want to iterate through and then you say what you want to do with each of those values. This is a slightly more complicated example but still has the same basic setup:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co">#In this example, we&#39;re going to start with a vector of numbers and we&#39;re going to add the numbers to a new vector if and only if the number is less than 5</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2">allValues &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>) <span class="co">#This is our vector containing all of the values</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3">valuesLessThan5 &lt;-<span class="st"> </span><span class="kw">c</span>() <span class="co">#This is an empty vector, we create it as we would a normal vector but we don&#39;t yet put any data in it, we&#39;re going to add the numbers in allValues to this if they are less than 5</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="cf">for</span> (eachValue <span class="cf">in</span> allValues) { <span class="co">#Iterate through the values in allValues</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5">  <span class="cf">if</span> (eachValue <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>) { <span class="co">#Check if the value is less than 5</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6">    valuesLessThan5 &lt;-<span class="st"> </span><span class="kw">c</span>(valuesLessThan5,eachValue)}} <span class="co">#If it is, add it to vector valuesLessThan5</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7">valuesLessThan5</a></code></pre></div>
<p>As before, we here iterate through the 5 numbers in allValues. We only want to continue with the value if it is less than 5 and we check that using the line “if (eachValue &lt; 5) {”. The if statement checks if a particular condition specified between “(” and “)” is met and if and only if it is, will run the code between “{” and “}”. Here, we check if the current value we’re on in the iteration is less than 5 and if it is we continue. If it isn’t, R will move on to the next value in the for loop. If the value is less than 5 we add it to the end of the vector valuesLessThan5. Here, we have two pairs of “{}” brackets, one for the for loop and one for the if statement. These define the start and end of the code associated with the for loop and if statement so we have to keep track of these and make sure we close them at the right point.</p>
<p>Combining for loops and if statements can be very useful when analysing data. For example, you can go through all of the genes in your gene list with the for loop and keep or discard the gene if it matches some condition in the if statement.</p>
<hr />
<p><strong>Exercises</strong></p>
<ol start="9" style="list-style-type: decimal">
<li>Using your TV show data frame from exercise 4 (recreate it if you need to), use a for loop to print each of the TV shows in turn (HINT: Pick out the column first)</li>
<li>Combine a for loop and if statement to print the number of episodes you’ve watched if this is more than 5</li>
</ol>
<hr />
</div>
<div id="reading-and-writing-files" class="section level1">
<h1><span class="header-section-number">8</span> Reading and writing files</h1>
<p>All of the examples we’ve run so far have been using example data that we’ve coded in R ourselves as part of the example. But how do you use your data and how can you save the output from your code? R contains a whole series of functions to read in and save pretty much any type of data you can imagine. For more complicated data types, the functions to read in and save the data are often included in their specialised libraries. Here, we’re first going to save a data frame to a file and then read that data frame back into R. We’ll start by recreating one of the data frames we used earlier:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">memPotDF &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Sample =</span> <span class="kw">c</span>(<span class="st">&quot;Sample1&quot;</span>,<span class="st">&quot;Sample2&quot;</span>,<span class="st">&quot;Sample3&quot;</span>,<span class="st">&quot;Sample4&quot;</span>,<span class="st">&quot;Sample5&quot;</span>), <span class="dt">Measurement1 =</span> <span class="kw">c</span>(<span class="fl">1.2</span>,<span class="fl">1.4</span>,<span class="fl">2.5</span>,<span class="fl">2.7</span>,<span class="fl">1.6</span>), <span class="dt">Measurement2 =</span> <span class="kw">c</span>(<span class="fl">1.4</span>,<span class="fl">1.5</span>,<span class="fl">2.2</span>,<span class="fl">2.8</span>,<span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw">print</span>(memPotDF)</a></code></pre></div>
<p>We’ve got a data frame here with 3 columns and 5 rows. First, before we focus on how to save a file, where will R save it? RStudio will save files in the folder you are currently running it in. By default this will be your home directory. Its usually best to change this and you do that in the bottom left window. If you want to save things in your Documents folder, you’d type:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">setwd</span>(<span class="st">&quot;Documents&quot;</span>)</a></code></pre></div>
<p>The setwd command sets the working directory and the folder in the quotes will be where the working directory is set. If you’re not sure where the current folder is type setwd(&quot;“) and then with your cursor between the quotes press tab twice on your keyboard. This will show you the options. You can continue to add directories as you would click through folders to set the location you’d like to save files. The directories need to be given relative to the directory you are currently in. So if you type setwd(”Documents“) and there’s no directory called”Documents&quot; in your current directory, R won’t know which directory you want to change to. If you’re not sure which directory you’re currently in, typing setwd(“~”) will take you to your home directory and you can change through the directories from there.</p>
<p>We can now save our data frame. You can save it in any format you want, let’s try two common ones:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">write.csv</span>(memPotDF,<span class="st">&quot;test_save_R_data.csv&quot;</span>,<span class="dt">row.names=</span><span class="ot">FALSE</span>,<span class="dt">quote=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw">write.table</span>(memPotDF,<span class="st">&quot;test_save_R_data.txt&quot;</span>,<span class="dt">row.names=</span><span class="ot">FALSE</span>,<span class="dt">quote=</span><span class="ot">FALSE</span>,<span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</a></code></pre></div>
<p>These two commands save our data frame as a csv file and text file, respectively. As with all commands, you can use ?write.csv and ?write.table to see the full list of options. But the first thing we give the command is the name of the data frame we want to save, here memPotDF. We then give it the name of the file. And then some options, I tend to use row.names=FALSE as I don’t want the names of the rows, and quote=FALSE as I don’t want quotes. The function write.csv will save a csv file with each column separated by “,”. The function write.table is a bit more flexible and you can have any character between columns. You set the column delimiter you want using sep and here we’ve separated columns with a tab, denoted by “\t”. You can also write a csv file with write.table by using sep=“,”.</p>
<p>Now that we’ve saved the data frame, let’s read it back in again! To do that, we can use:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">newMemPotDF &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;test_save_R_data.csv&quot;</span>)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">newMemPotDF &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;test_save_R_data.txt&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>You’ll need to use the setwd command to get RStudio in the same directory as the file you want to read in or give the read.csv or read.table commands the file path relative to the current working directory. The read.csv command is nice and simple. You just give it the name of the csv file you want to read in. Make sure its a csv file though as read.csv won’t work properly with any other type of file. The read.table command can read files in with columns separated by any delimiter. You tell the command what the column delimiter is using sep, here a tab. You also need to tell read.table that your file contains column names using header=TRUE. If it doesn’t, you can leave this part out.</p>
<hr />
<p><strong>Exercises</strong></p>
<ol start="11" style="list-style-type: decimal">
<li>Save your TV show data frame from exercise 4 (recreate it if you need to) as a csv file</li>
<li>Read the csv file you just saved into R</li>
</ol>
<hr />
</div>
<div id="plots-and-ggplot" class="section level1">
<h1><span class="header-section-number">9</span> Plots and ggplot</h1>
<p>One of the great strengths of R is its plots. The basic plots are nice but ggplot produces much nicer plots, but does take a bit of getting used to. You’ll most often plot data from a data frame. Let’s set up a basic data frame of membrane potential measurements as we have before:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">memPotDF &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Sample =</span> <span class="kw">c</span>(<span class="st">&quot;Sample1&quot;</span>,<span class="st">&quot;Sample2&quot;</span>,<span class="st">&quot;Sample3&quot;</span>,<span class="st">&quot;Sample4&quot;</span>,<span class="st">&quot;Sample5&quot;</span>,<span class="st">&quot;Sample6&quot;</span>,<span class="st">&quot;Sample7&quot;</span>,<span class="st">&quot;Sample8&quot;</span>,<span class="st">&quot;Sample9&quot;</span>,<span class="st">&quot;Sample10&quot;</span>), <span class="dt">Measurement1 =</span> <span class="kw">c</span>(<span class="fl">1.2</span>,<span class="fl">1.4</span>,<span class="fl">2.5</span>,<span class="fl">2.7</span>,<span class="fl">1.6</span>,<span class="fl">2.4</span>,<span class="fl">2.2</span>,<span class="fl">1.9</span>,<span class="fl">1.4</span>,<span class="fl">1.5</span>), <span class="dt">Measurement2 =</span> <span class="kw">c</span>(<span class="fl">1.4</span>,<span class="fl">1.5</span>,<span class="fl">2.2</span>,<span class="fl">2.8</span>,<span class="fl">1.5</span>,<span class="fl">2.5</span>,<span class="fl">2.2</span>,<span class="fl">1.7</span>,<span class="fl">1.4</span>,<span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="kw">print</span>(memPotDF)</a></code></pre></div>
<p>We’ve now got 10 samples each of which has 2 measurements. Let’s do a basic plot and see if there’s a correlation between the 2 measurements:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">plot</span>(memPotDF<span class="op">$</span>Measurement1,memPotDF<span class="op">$</span>Measurement2)</a></code></pre></div>
<p>You should get a plot that looks like:</p>
<p><img src="introduction.to.R_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>We’ve plotted column Measurement1 in memPotDF (specified using $) against column Measurement2 in memPotDF. It looks like there’s a correlation between the measurements, although we should probably do some stats on it, more on that in a later part of the course. That plot looks fine but ggplot plots look much nicer! We’ll need to load the library ggplot2 to use these plots and the code we use will be slightly different:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="kw">ggplot</span>(memPotDF,<span class="kw">aes</span>(<span class="dt">x =</span> Measurement1, <span class="dt">y =</span> Measurement2)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p>The code we write for ggplot is a bit unusual and its not quite as simple to understand as for the standard plot. We start the plot command with ggplot(). The first item in the brackets (memPotDF) tells R which data frame we want to plot. Within the aes() brackets, we say what column name we’d like on the x-axis and what column name we’d like on the y-axis. R uses the column names to pick out the data to plot. You then add additional parts to the plot with “+”. Here, we’ve added “+ theme_classic()” which plots on a white background instead of the standard grey. And we’ve added “+ geom_point()” which tells R that we want to plot the data as points. This should give us a plot that looks like:</p>
<p><img src="introduction.to.R_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>Which looks a bit nicer than the standard plot. Working with ggplot is an entire tutorial in itself as you can add colours, shapes and other datasets to the plot as well as changing a huge number of different plot aspects. The pages at <a href="https://ggplot2.tidyverse.org/" class="uri">https://ggplot2.tidyverse.org/</a> provide a good guide to ggplot.</p>
<hr />
<p><strong>Exercises</strong></p>
<ol start="13" style="list-style-type: decimal">
<li>Plot your TV watching data from exercise 4 as a barplot using ggplot2. You’ll need to switch “+ geom_point()” in the above example for “+ geom_bar(stat=”identity“)”</li>
</ol>
<hr />
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
